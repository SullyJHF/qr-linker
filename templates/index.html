<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>{{.Title}}</h1>
      </header>

      <main>
        <div class="url-shortener-card">
          <h2>Shorten Your URL</h2>
          <p>Enter a URL below to create a short link</p>

          <form id="url-form" action="/shorten" method="POST">
            <div class="form-group">
              <input
                type="url"
                name="url"
                id="url-input"
                placeholder="https://example.com/your-long-url"
                required
                class="url-input"
              />
              <button type="submit" class="btn-primary">Shorten URL</button>
            </div>
          </form>

          {{if .ShortURL}}
          <div class="result-card">
            <h3>Success! Your short URL is:</h3>
            <div class="short-url-display">
              <a href="{{.ShortURL}}" target="_blank">{{.Host}}{{.ShortURL}}</a>
              <button
                onclick="copyToClipboard('{{.Host}}{{.ShortURL}}')"
                class="btn-copy"
              >
                Copy
              </button>
            </div>
          </div>
          {{end}} {{if .Error}}
          <div class="error-message">
            <p>{{.Error}}</p>
          </div>
          {{end}}
        </div>

        <div class="recent-urls">
          <h3>Recent URLs</h3>
          {{if .URLs}}
          <table class="url-table">
            <thead>
              <tr>
                <th>Short Link</th>
                <th>Original URL</th>
                <th>Clicks</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody>
              {{range .URLs}}
              <tr>
                <td>
                  <a href="/{{.ShortHash}}" target="_blank">/{{.ShortHash}}</a>
                </td>
                <td class="truncate">{{.FullURL}}</td>
                <td>{{.Clicks}}</td>
                <td>{{.CreatedAt.Format "Jan 02, 2006"}}</td>
              </tr>
              {{end}}
            </tbody>
          </table>
          {{else}}
          <p class="no-urls">No URLs shortened yet. Be the first!</p>
          {{end}}
        </div>
      </main>

      <script>
        function copyToClipboard(text) {
          navigator.clipboard.writeText(text).then(function () {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = "Copied!";
            setTimeout(() => {
              btn.textContent = originalText;
            }, 2000);
          });
        }
      </script>

      <footer>
        <p>&copy; 2025 QR Linker.</p>
      </footer>
    </div>
  </body>
</html>
